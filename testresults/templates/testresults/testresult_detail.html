{# Load the tag library #}
{% load bootstrap3 %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}

{% load mptt_tags %}


{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Unit</th>
      <th>Unit Type</th>
      <th>Event</th>
      <th>SObject</th>
      <th>Duration</th>
      <th>SOQL Used</th>
      <th>SOQL Used (Test)</th>
      <th>DML Used</th>
      <th>DML Used (Test)</th>
    </tr>
  </thead>
  <tbody>
{% recursetree testresult.codeunits.all %}
    <tr>
      <td>{{ node.unit }}</td>
      <td>{{ node.unit_type }}</td>
      <td>{{ node.event }}</td>
      <td>{{ node.sobject }}</td>
      <td>{{ node.duration }}</td>
      <td>{{ node.soql_queries_used }}</td>
      <td>{{ node.test_soql_queries_used }}</td>
      <td>{{ node.dml_rows_used }}</td>
      <td>{{ node.test_dml_rows_used }}</td>
    </tr>
    {% if not node.is_leaf_node %}
    <tr>
      <td colspan="9">
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Unit</th>
              <th>Unit Type</th>
              <th>Event</th>
              <th>SObject</th>
              <th>Duration</th>
              <th>SOQL Used</th>
              <th>SOQL Used (Test)</th>
              <th>DML Used</th>
              <th>DML Used (Test)</th>
            </tr>
          </thead>
          <tbody>
            {{ children }}
          </tbody>
        </table>
      </td>
    </tr>
    {% endif %}
{% endrecursetree %}
  </tbody>
</table>

{% comment %}
<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Class</th>
      <th>Method</th>
      <th>Result</th>
      <th>Duration</th>
      <th>SOQL Used</th>
      <th>SOQL Used (Test)</th>
      <th>DML Used</th>
      <th>DML Used (Test)</th>
    </tr>
  </thead>
  <tbody>
  {% for codeunit in testresults.all %}
    {% with codeunit=result.get_main_code_unit %}
    <tr>
      <td>{{ result.method.testclass.name }}</td>
      <td>{{ result.method.name }}</td>
      <td>{{ result.outcome }}</td>
      <td>{{ result.duration }}</td>
      <td>{{ codeunit.soql_queries_used }}</td>
      <td>{{ codeunit.test_soql_queries_used }}</td>
      <td>{{ codeunit.dml_queries_used }}</td>
      <td>{{ codeunit.test_dml_queries_used }}</td>
    </tr>
    {% endwith %}
  {% endfor %}
  <tbody>
</table>
{% endcomment %}
